<!DOCTYPE html>
<html lang="en">
<head>

  <!-- Basic Page Needs
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta charset="utf-8">
  <title>Your page title here :)</title>
  <meta name="description" content="">
  <meta name="author" content="">

  <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- FONT
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->


  <!-- CSS
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="stylesheet" href="skel_css/normalize.css">
  <link rel="stylesheet" href="skel_css/skeleton.css">

  <!-- Favicon
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="icon" type="image/png" href="favicon.ico">
  
  <!-- DYGRAPH -->
  <link rel="stylesheet" href="dygraph.css">
  <script type="text/javascript" src="dygraph.js"></script>

</head>
<body>

  <!-- Primary Page Layout
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <div class="container">
    <div class="row">
      <div class="twelve columns" style="margin-top: 1%">      

		<h3>Measuring data collection and presentation</h3>

		<input type="text" id="txtMeasurement"/>
		<div>Count of channels:&nbsp;
			<select id="countOfChannels" onchange="ChannelCountChanged()" style="width: 90px">
			  <option value=1>1</option>
			  <option value=2>2</option>
			  <option value=3>3</option>
			</select>
		</div>
		
		<div id="graphdiv" style="width:100%; height:500px;"></div>
		
		<p>&nbsp;</p>
		
															
		
		<script>
		
		var data = [];
		// data.push([0, 0, 0, 0]);
		
		var countOfChannels = 1;
		var actualChannelNr = 1;
		var channel1 = 0;
		var channel2 = 0;
		var graphCountOfValues = 50;
		var enteredValue;
		
		// fill initial values into data array
		for (i = 0; i <= graphCountOfValues; i++) { 
			data.push([i, null, null, null]);
		}
		var rovNumber = 0;
		
		//	graph and his basic properties
		g = new Dygraph(
			document.getElementById("graphdiv"), 
			data, 
			{
				digitsAfterDecimal: 3, 
				drawPoints: true, 
				drawAxesAtZero: true, 
				axisLineWidth: 1.3, 
				axisTickSize: 3.0, 
				labels: ['Nr.', 'Ch1.', 'Ch2.', 'Ch3.'],
				colors: ['#CC0000', '#00CC00', '#0000CC'],
				strokeWidth: 2  
			}
		);

		
		window.onload = function() {
			//alert("Hello\nOn load.");
			document.getElementById("txtMeasurement").addEventListener("keydown", DataEntry);

			//var str = document.getElementById("countOfMeasurement").value;
			document.getElementById("txtMeasurement").focus();					
		};
		
		function DataEntry(e) {
			var minSec = ""; 
			if (e.keyCode === 13) {  //checks whether the pressed key is "Enter"
			
				enteredValue =   (document.getElementById("txtMeasurement").value).replace(',', '.');
				
				var d = new Date();
				minSec = d.getMonth() + ":" + d.getSeconds();
				//alert(minSec);
				
				switch(countOfChannels){
					// ....................................................................................
					case 1:
						// add new data into data array for chart
						if (rovNumber <= graphCountOfValues){
							// first N values into empty graph
							data[rovNumber] = [rovNumber, Number(enteredValue), null, null];   
						} 
						else {
							// shifting graph lines
							data.push([rovNumber, Number(enteredValue), null, null]);
							data.shift();
						}
						rovNumber = rovNumber + 1;
						break;
					
					// ....................................................................................
					case 2:
						if(actualChannelNr == 1){
							// entered value for channel 1
							channel1 = Number(enteredValue);
							actualChannelNr = actualChannelNr + 1;
						}
						else{
							// entered bvalue for channel 2
							if (rovNumber <= graphCountOfValues){
								// first N values into empty graph
								data[rovNumber] = [rovNumber, channel1, Number(enteredValue), null];   
							} 
							else {
								// shifting graph lines
								data.push([rovNumber, channel1, Number(enteredValue), null]);
								data.shift();
							}
							actualChannelNr = 1;
							rovNumber = rovNumber + 1;
						}
						break;
					
					// ....................................................................................
					case 3:
						if(actualChannelNr == 1){
							// entered value for channel 1
							channel1 = Number(enteredValue);
							actualChannelNr = actualChannelNr + 1;
						}
						else{
							if(actualChannelNr == 2){
								// entered value for channel 2
								channel2 = Number(enteredValue);
								actualChannelNr = actualChannelNr + 1;									
							}
							else{
								// entered value for channel 3
								if (rovNumber <= graphCountOfValues){
									// first N values into empty graph
									data[rovNumber] = [rovNumber, channel1, channel2, Number(enteredValue)];   
								} 
								else {
									// shifting graph lines
									data.push([rovNumber, channel1, channel2, Number(enteredValue)]);
									data.shift();
								}
								actualChannelNr = 1;
								rovNumber = rovNumber + 1;									
							}
						}
						break;							
				}
				
				// common
				g.updateOptions( { 'file': data } );
				this.value = "";
				
			}
		}
		
		function ChannelCountChanged() {
			// alert("ChannelCountChanged to " + document.getElementById("countOfChannels").value);
			countOfChannels = Number(document.getElementById("countOfChannels").value);
			document.getElementById("txtMeasurement").focus();
		}
		
		</script>
		
		
      </div>
    </div>
  </div>

<!-- End Document
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
</body>
</html>
