<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <title>Mitutoyo Česko</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Html5TemplatesDreamweaver.com">

    <link href="scripts/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="scripts/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Icons -->
    <link href="scripts/icons/general/stylesheets/general_foundicons.css" media="screen" rel="stylesheet" type="text/css" />  
    <link href="scripts/icons/social/stylesheets/social_foundicons.css" media="screen" rel="stylesheet" type="text/css" />
	<link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
    <!--[if lt IE 8]>
        <link href="scripts/icons/general/stylesheets/general_foundicons_ie7.css" media="screen" rel="stylesheet" type="text/css" />
        <link href="scripts/icons/social/stylesheets/social_foundicons_ie7.css" media="screen" rel="stylesheet" type="text/css" />
    <![endif]-->
    <link rel="stylesheet" href="scripts/fontawesome/css/font-awesome.min.css">
    <!--[if IE 7]>
        <link rel="stylesheet" href="scripts/fontawesome/css/font-awesome-ie7.min.css">
    <![endif]-->

    <link href="https://fonts.googleapis.com/css?family=Syncopate" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Abel" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Pontano+Sans" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Oxygen" rel="stylesheet" type="text/css">

    <link href="styles/custom.css" rel="stylesheet" type="text/css" />
	
	<style>
		.channelValue { font-size:55px; color:#aaaaaa; text-align: right; margin: 0px 100px 0px 55px; float:left;}
		video {
		  width: 420px   !important;
		  height: auto   !important;
		  margin-left: auto;
		  margin-right: auto;
		  display: block;
		}
		
		
		span {
			font-family: 'Courier New';
			font-size: 10pt;
			color: #000000;
		}
		.sc0 {
		}
		.sc1 {
			color: #008000;
		}
		.sc2 {
			color: #FF0000;
		}
		.sc3 {
			color: #808080;
		}
		.sc4 {
			color: #808080;
		}
		.sc5 {
			font-weight: bold;
			color: #0000FF;
		}
		.sc9 {
			color: #FF00FF;
		}
		.sc10 {
			font-weight: bold;
			color: #000080;
		}
		.sc11 {
		}
		
</style>
		
	</style>
</head>
<body id="pageBody">

<div id="divBoxed" class="container">

    <div class="transparent-bg" style="position: absolute;top: 0;left: 0;width: 100%;height: 100%;z-index: -1;zoom: 1;"></div>

    <div class="divPanel notop nobottom">
            <div class="row-fluid">
                <div class="span12">

                    <div id="divLogo" class="pull-left">
                        <a href="index.html" id="divSiteTitle"><img src="images/mit_logo.png" alt="Mitutoyo" title="Mitutoyo" /></a>
                        <br />
                        <a href="index.html" id="divTagLine">Stránky aplikační podpory</a>	
                    </div>

                    <div id="divMenuRight" class="pull-right">
                    <div class="navbar">
                        <button type="button" class="btn btn-navbar-highlight btn-large btn-primary" data-toggle="collapse" data-target=".nav-collapse">
                            NAVIGATION <span class="icon-chevron-down icon-white"></span>
                        </button>

						
						
                    </div>

                </div>
            </div>

            <div class="row-fluid">
                <div class="span12">
                    <div id="contentInnerSeparator"></div>
                </div>
            </div>
    </div>

    <div class="contentArea">

        <div class="divPanel notop page-content">

            <div class="breadcrumbs">
                <a href="index.html">Home</a> &nbsp;/&nbsp; <span>Code Examples</span>
            </div>

            <div class="row-fluid">
            <!--Edit Main Content Area here-->
                <div class="span12" id="divMain">

	<h1>Python code examples</h1>
	<h2>Data handling with DIGIMATIC device</h2>
	
	<p>Communication with DIGIMATIC devices is easy to realize using USB-ITN cables. Cables contain the convertor with functionality DIGIMATIC -> HID or DIGIMATIC -> VCP (Virtual Com Port) if the appropriate driver is installed. A small disadvantage is that such a driver exists for Windows platform only. Generally, serial connection (VCP or RS232) is used by communication between PC and Mitutoyo instruments.
	</p>
	
	<h3>Set up</h3>
	<p><strong>Step 1:</strong> connect the instrument using ITNUSB cable.
	</p>
	<p><strong>Step 2:</strong> install the driver for Virtual Com Port (VCP). This driver is for example in IT-PAK. Note: it works on Windows OS only. Now, the virtual COM is installed on the computer. Check the result in Device manager and remember the number of a serial port (for example COM4).
	</p>
	<p><strong>Step 3:</strong> check the communication between PC and device using a serial terminal. Use for example <a href="https://mitutoyocz.github.io/apps//drivers/SerialTerminal_ML.zip">this</a>, it is a lightweight portable version (without installation). Send a request manually: 1{CR}. Then you should receive a response from an instrument in MUX10 format: 01A+00018.23{CR}.
	</p>
	<p><strong>Step 4:</strong> apply the request-response routines in programming code.
	</p>
	
	<h3>PYTHON 3</h3>
	<p>This code example is minimalistic. It presents the basic communication and decoding of MUX10 format to the value.<br />
	External <strong>PySerial</strong> package is used here.
	</p>
	<p><strong>IMPORTANT:</strong> correct com port number by <i>Step 2)</i> must be used in this code (line 26): <i>serialPort = serial.Serial(<strong>'COM4'</strong>, 9600, timeout=1)</i>
	</p>	
	<br />
	
	<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1"># This is a sample Python script for communication with DIGIMATIC devices</span><span class="sc0">
</span><span class="sc1"># Mitutoyo Cesko s.r.o., Martin Marusak,</span><span class="sc0">

</span><span class="sc5">import</span><span class="sc0"> </span><span class="sc11">serial</span><span class="sc0">


</span><span class="sc5">def</span><span class="sc0"> </span><span class="sc9">mux10_decode</span><span class="sc10">(</span><span class="sc11">mux10_bytes</span><span class="sc10">):</span><span class="sc0">
    </span><span class="sc1"># It decodes MUX10 data to the value. Example: 01A+00003.141 -&gt; 3.141</span><span class="sc0">
    </span><span class="sc1"># mux10_string: ASCII bytes</span><span class="sc0">
    </span><span class="sc1"># Return: float</span><span class="sc0">
    
    </span><span class="sc1"># cut first 3 bytes</span><span class="sc0">
    </span><span class="sc11">mux10_bytes</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">mux10_bytes</span><span class="sc0"> </span><span class="sc10">[</span><span class="sc2">3</span><span class="sc10">:]</span><span class="sc0">
    </span><span class="sc1"># convert to float</span><span class="sc0">
    </span><span class="sc5">try</span><span class="sc10">:</span><span class="sc0">
        </span><span class="sc11">mux10_float</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">float</span><span class="sc10">(</span><span class="sc11">mux10_bytes</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">mux10_float</span><span class="sc0">
    </span><span class="sc5">except</span><span class="sc10">:</span><span class="sc0">    
        </span><span class="sc5">print</span><span class="sc10">(</span><span class="sc4">'Error by conversion to float: '</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">mux10_bytes</span><span class="sc10">.</span><span class="sc11">decode</span><span class="sc10">(</span><span class="sc3">"utf-8"</span><span class="sc10">))</span><span class="sc0">
    

</span><span class="sc1"># ========================================   M A I N   C O D E   ========================================</span><span class="sc0">
</span><span class="sc11">serialPort</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">None</span><span class="sc0">

</span><span class="sc1"># SERIAL PORT PARAMETER SETTING</span><span class="sc0">
</span><span class="sc11">serialPort</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">serial</span><span class="sc10">.</span><span class="sc11">Serial</span><span class="sc10">(</span><span class="sc4">'COM4'</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc2">9600</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">timeout</span><span class="sc10">=</span><span class="sc2">1</span><span class="sc10">)</span><span class="sc0">

</span><span class="sc1"># open serial port</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc5">not</span><span class="sc0"> </span><span class="sc11">serialPort</span><span class="sc10">.</span><span class="sc11">isOpen</span><span class="sc10">():</span><span class="sc0">
    </span><span class="sc11">serialPort</span><span class="sc10">.</span><span class="sc11">open</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc5">else</span><span class="sc10">:</span><span class="sc0">
    </span><span class="sc5">print</span><span class="sc10">(</span><span class="sc4">'Serial port is open.'</span><span class="sc10">)</span><span class="sc0">

</span><span class="sc11">serialPort</span><span class="sc10">.</span><span class="sc11">reset_input_buffer</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc11">serialPort</span><span class="sc10">.</span><span class="sc11">reset_output_buffer</span><span class="sc10">()</span><span class="sc0">

</span><span class="sc1"># ----  REQUEST data from DIGIMATIC ITN on VCP</span><span class="sc0">
</span><span class="sc11">serialPort</span><span class="sc10">.</span><span class="sc11">write</span><span class="sc10">(</span><span class="sc3">"1\r"</span><span class="sc10">.</span><span class="sc11">encode</span><span class="sc10">())</span><span class="sc0">

</span><span class="sc1"># ----  handle RESPONSE from DIGIMATIC ITN on VCP</span><span class="sc0">
</span><span class="sc11">serial_line_receiwed</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">serialPort</span><span class="sc10">.</span><span class="sc11">readline</span><span class="sc10">()</span><span class="sc0">

</span><span class="sc1"># ----  Result output</span><span class="sc0">
</span><span class="sc5">print</span><span class="sc10">(</span><span class="sc4">'Received in MUX10 format: '</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">serial_line_receiwed</span><span class="sc10">.</span><span class="sc11">decode</span><span class="sc10">(</span><span class="sc3">"utf-8"</span><span class="sc10">))</span><span class="sc0">
</span><span class="sc5">print</span><span class="sc10">(</span><span class="sc4">'Received value: '</span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">str</span><span class="sc10">(</span><span class="sc11">mux10_decode</span><span class="sc10">(</span><span class="sc11">serial_line_receiwed</span><span class="sc10">)))</span><span class="sc0">

</span><span class="sc1"># close serial port</span><span class="sc0">
</span><span class="sc11">serialPort</span><span class="sc10">.</span><span class="sc11">close</span><span class="sc10">()</span></div>
					

					
                </div>
            <!--End Main Content Area-->
            </div>

            <div id="footerInnerSeparator"></div>
        </div>
    </div>

    <div id="footerOuterSeparator"></div>

<div id="divFooter" class="footerArea">

        <div class="divPanel">

            <div class="row-fluid">
                <div class="span3" id="footerArea1">
                
                    <h3>O těchto stránkách</h3>

                    <p>Obsah těchto stránek je určen pro poskytování aplikační podpory. Jde o prezentaci podrobnějších informací k některým produktům o demonstraci příkladů úspěšných řešení.
					<br />  
					Stránky poskytují doplňující informace k hlavním stránkám společnosti 
					<a href="http://www.mitutoyo.cz" title="Email">www.mitutoyo.cz</a>.</p>                    
                </div>
                
                <div class="span3" id="footerArea2">
				
                </div>
                
                <div class="span3" id="footerArea3">
                </div>
                
                <div class="span3" id="footerArea4">

                    <h3>Mitutoyo Česko s.r.o.</h3>  
                                                               
                    <ul id="contact-info">
                    <li>                                    
                        <i class="general foundicon-phone icon"></i>
                        <span class="field">Tel.:</span>
                        <br />
                        +420 417 514 023                                                               
                    </li>
                    <li>
                        <i class="general foundicon-mail icon"></i>
                        <span class="field">Email:</span>
                        <br />
                        <a href="mailto:scales@mitutoyo.cz" title="Email">scales@mitutoyo.cz</a>
                    </li>
                    <li>
                        <i class="general foundicon-home icon" style="margin-bottom:50px"></i>
                        <span class="field">Adresa:</span>
                        <br />
                        Dubská 1626<br />
                        415 01 Teplice<br />
                        Česká republika
                    </li>
                    </ul>

                </div>
            </div>

            <br /><br />
            <div class="row-fluid">
                <div class="span12">
                    <p class="copyright">
                        Copyright © 2017 Mitutoyo Česko s.r.o. Všechna práva vyhrazena.
                    </p>
                </div>
            </div>

        </div>
    </div>
</div>
<br />

<script src="scripts/jquery.min.js" type="text/javascript"></script> 
<script src="scripts/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
<script src="scripts/default.js" type="text/javascript"></script>


</body>
</html>